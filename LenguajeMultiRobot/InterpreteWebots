#!/bin/bash

PARAM_JAVA="$1"

export LD_LIBRARY_PATH="./lib"

# 1. Detectar Webots con mÃºltiples mÃ©todos
if pgrep -f webots >/dev/null 2>&1; then
    echo "âœ… Webots detectado (pgrep/pidof)"
else
    echo "ğŸš€ Arrancando Webots..."
    webots src/robolang_webots/MiniMundo.wbt &
    sleep 5
fi

# 2. Lanzar controlador
echo "âš™ï¸  Controlador: interpretes.InterpreteWebots $PARAM_JAVA"
java -cp bin:lib/Controller.jar:lib/antlr-4.13.2-complete.jar \
     -Djava.library.path=lib \
     interpretes.InterpreteWebots "$PARAM_JAVA"

